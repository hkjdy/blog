---
date: 2016/6/21 星期二  18:15:51+0800
layout: post
title: Java创建字符串的两种方式
thread: 164
categories: Java
tags:  string
---
Java中创建字符串的方式有两种：

```java
String x = "abc";
String y = new String("abc");
```

二者区别是什么？

1.双引号 vs. 构造函数
------

这个问题可以通过两段简单的代码示例来回答。

Example 1:

```java
String a = "abcd";
String b = "abcd";
System.out.println(a == b);  // True
System.out.println(a.equals(b)); // True
```

a==b 结果为 true 是因为在JVM [方法区(method area)](http://www.programcreek.com/2013/04/jvm-run-time-data-areas/)中a和b引用了相同的字符串字面量。相同的字符串字面量引用相同的内存地址。

相同的字符串字面量被创建多次，只有一份副本会被存储。叫做“字符串驻留”(string interning)。Java中所有的常量字符串都会自动驻留。

Example 2:
```java
String c = new String("abcd");
String d = new String("abcd");
System.out.println(c == d);  // False
System.out.println(c.equals(d)); // True
```
c==d 结果为false，是因为c和d在堆内存中引用的是不同的对象，不同的对象总是引用不同的内存地址。

下图演示了这两种情景:

![](/assets/constructor-vs-double-quotes-Java-String-New-Page-650x324.png)


2.运行时字符串驻留
------

即使两个字符串是通过构造函数创建的，在运行期间也会执行字符串驻留： 

```java
String c = new String("abcd").intern();
String d = new String("abcd").intern();
System.out.println(c == d);  // Now true
System.out.println(c.equals(d)); // True
```

3.如何选择
------

因为字面量"abcd"已经是一个String类型，使用构造函数会额外创建一个多余的对象。因此，如果仅需要创建一个String你应该使用双引号。

如果需要在堆中创建新对象，你应该使用构造函数。[这里](http://www.programcreek.com/2013/09/the-substring-method-in-jdk-6-and-jdk-7/)是一个使用构造函数的实例。

原文：[Create Java String Using "" or Constructor?](http://www.programcreek.com/2014/03/create-java-string-by-double-quotes-vs-by-constructor/)